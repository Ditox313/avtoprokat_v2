<form class="xs_add__car" [formGroup]="form" (ngSubmit)="onSubmit()">
    <div class="xs_add__car___top">
        <h1>
            <span class="material-icons">contact_mail</span> Обновить бронь
        </h1>

        <div class="xs_add__car__top____actions">
            <a routerLink="/bookings-page" *ngIf="!bookingViewRef">
                <span class="material-icons">arrow_back_ios</span>Назад
            </a>

            <a [routerLink]="['/view-booking',this.bookingId]" *ngIf="bookingViewRef">
                <span class="material-icons">arrow_back_ios</span>Назад
            </a>
            
            <button type="submit">
                <span class="material-icons">beenhere</span>Сохранить
            </button>
        </div>
    </div>

    <div class="xs_add__car__content">
        <div class="row">
            <div class="col s12">
                <ul class="tabs" #tabs>
                    <li class="tab col"><a href="#information" class="active">Общая информация</a></li>
                </ul>
            </div>

            <div id="information" class="col s12">
                <div class="xs_form">
                    <div class="xs_form__item">
                        <div class="xs_form__item___mod">
                            <label for="marka">Автомобиль<span class="xszv">*</span></label>
                            <div class="input-field col s12">
                                <select id="car" formControlName="car"
                                    [ngClass]="{'invalid': form.controls['car'].invalid && form.controls['car'].touched}"  (ngModelChange)="onChangeCar($event)">
                                    <option value="" disabled selected>Выберите автомобиль</option>
                                    <option *ngFor="let xscar of xscars$ | async" value="{{xscar | json}}">
                                        {{xscar.marka}} {{xscar.model}} ({{xscar.number}})</option>

                                </select>
                            </div>
                        </div>


                        <div class="input-field col s12">
                            <div><label for="marka">Дата начала брони<span class="xszv">*</span></label></div>
                            <input placeholder="Введите значение" id="booking_start" type="datetime-local" class="validate"
                                formControlName="booking_start"
                                [ngClass]="{'invalid': form.controls['booking_start'].invalid && form.controls['booking_start'].touched}"
                                (change)="bookingStartDate($event)" >
                        </div>


                        <div class="input-field col s12">
                            <input placeholder="Введите значение" id="place_start" type="text" class="validate"
                                formControlName="place_start"
                                [ngClass]="{'invalid': form.controls['place_start'].invalid && form.controls['place_start'].touched}">
                            <label for="marka">Место выдачи<span class="xszv">*</span></label>
                            <span class="helper-text red-text"
                                *ngIf="form.controls['place_start'].invalid && form.controls['place_start'].touched">
                                <p *ngIf="form.controls['place_start'].errors?.required">
                                    Поле не должно быть пустым
                                </p>
                            </span>
                        </div>


                        <div>
                            <label for="marka">Тариф<span class="xszv">*</span></label>
                            <div class="input-field col s12">
                                <select id="tariff" formControlName="tariff"
                                    [ngClass]="{'invalid': form.controls['tariff'].invalid && form.controls['tariff'].touched}" (ngModelChange)="onChangeTariff($event)">
                                    <option value="" disabled selected>Выберите тариф</option>
                                    <option value="Город">Город</option>
                                    <option value="Межгород">Межгород</option>
                                    <option value="Россия">Россия</option>
                                </select>
                            </div>
                        </div>

                    </div>

                    <div class="xs_form__item">
                        <div class="xs_form__item___mod xs_form__item___mod___client">
                            <label for="marka">Клиент<span class="xszv">*</span></label>
                            <div class="input-field col s12">
                                <select id="client" formControlName="client"
                                    [ngClass]="{'invalid': form.controls['client'].invalid && form.controls['client'].touched}">
                                    <option value="" disabled selected>Выберите клиента</option>
                                    <option *ngFor="let xsclient of xsclients$ | async" value="{{xsclient | json}}">
                                        {{xsclient.surname}} {{xsclient.name}} {{xsclient.lastname}}</option>
                                </select>
                            </div>
                        </div>

                        <div class="input-field col s12">
                            <div><label for="marka">Дата окончания брони<span class="xszv">*</span></label></div>
                            <input placeholder="Введите значение" id="booking_end" type="datetime-local" class="validate"
                                formControlName="booking_end"
                                [ngClass]="{'invalid': form.controls['booking_end'].invalid && form.controls['booking_end'].touched}"
                                (change)="bookingEndDate($event)">
                        </div>

                        <div class="input-field col s12">
                            <input placeholder="Введите значение" id="place_end" type="text" class="validate"
                                formControlName="place_end"
                                [ngClass]="{'invalid': form.controls['place_end'].invalid && form.controls['place_end'].touched}">
                            <label for="marka">Место приема<span class="xszv">*</span></label>
                            <span class="helper-text red-text"
                                *ngIf="form.controls['place_end'].invalid && form.controls['place_end'].touched">
                                <p *ngIf="form.controls['place_end'].errors?.required">
                                    Поле не должно быть пустым
                                </p>
                            </span>
                        </div>

                        <div class="input-field col s12 xs_textarea">
                            <textarea placeholder="Введите значение" id="comment" type="text"
                                class="materialize-textarea" formControlName="comment"
                                [ngClass]="{'invalid': form.controls['comment'].invalid && form.controls['comment'].touched}"> </textarea>
                            <label for="marka">Комментарий</label>
                            <span class="helper-text red-text"
                                *ngIf="form.controls['comment'].invalid && form.controls['comment'].touched">
                                <p *ngIf="form.controls['comment'].errors?.required">
                                    Поле не должно быть пустым
                                </p>
                            </span>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="xs_summa" *ngIf="this.summa.summa">
        <span>Аренда {{this.summa.summa | number: '1.0-0'}} ₽</span> + 
        <span>Залог {{this.summa.car.zalog}} ₽</span> + 
        <span>Доп.час{{this.summa.car.price_dop_hour}} ₽</span> =
        <span>Итого {{summa.summaFull | number: '1.0-0'}} ₽</span>
    </div>

    <div class="xs_add__car___top">
        <div class="xs_add__car__top____actions">
            <button type="submit">
                <span class="material-icons">beenhere</span>Сохранить
            </button>
        </div>
    </div>
</form>